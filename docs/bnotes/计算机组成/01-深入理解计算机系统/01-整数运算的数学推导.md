---
title: 整数运算的数学推导
date: 2024/6/14 10:34
categories:
 - 读书笔记
tags:
 - 计算机组成
---

# 整数运算的数学推导

::: INFO 参考资料
参考视频：[深入理解计算机系统](https://www.bilibili.com/video/BV1Ff4y1q7Kf/?share_source=copy_web&vd_source=57dbd16b8c7c2ad258cccce5966c5be8)
书：《CSAPP》
:::

## 整数的表示

### 无符号数

定义
![](/public/img/2024/f4fc3f0e308b0345d20a16818fc5519b.png)

表示范围
![](../../../public/img/2024/7f586b15e0e0f20026f9fd3bf6780ddf.png)

### 有符号数（补码）

定义
![](../../../public/img/2024/36ef0746046218ac168006e0ecd76a1d.png)


### 无符号数与有符号数的转化

![](../../../public/img/2024/08169adc3d5777c8def75981f15055e9.png)


### 有符号数（补码）的位扩展

![](../../../public/img/2024/e0c5c20a092e43d4aa1c95ac869f8064.png)

![](../../../public/img/2024/6f73783389b99a52e2e06266baaf204f.png)


### 截断无符号数

2进制数的截断操作，可以对应取模操作

![](../../../public/img/2024/7dc4bf62a250646a8d6f0bcdfc46ad73.png)

### 截断有符号数

同样是先当做无符号数直接截断，然后翻译成有符号数

![](../../../public/img/2024/3e867041bbca6f57186a78a761f3b856.png)

## 整数的加法运算

### 无符号加法

![](../../../public/img/2024/5b890fb0aaf4de478003ab2ecbbb097a.png)

c语言中检测溢出
![](../../../public/img/2024/91b187e4c5906ad304ff12bfc85c5789.png)
证明了溢出结果小于任意一个数。不溢出时是大于或等于任意一个数

### 有符号加法

![](../../../public/img/2024/f00f8213d71c424e5eadf0bd831c6597.png)

![](../../../public/img/2024/32cf8a1f23909e8ef9d3e39e53f8b9de.png)


## 整数的减法运算

在模系统中，减一个数等于加其逆元，逆元即相当于相反数

### 逆元的定义

![](../../../public/img/2024/d7cb7df992600aef5181e86e1ea6a9e4.png)
### 无符号数的逆元

![](../../../public/img/2024/0202e1b8ba8e7918ca24b8d7dba9aa62.png)
无符号，相加为2^w 时，溢出变0，其互为逆元

故对于一个无符号数，其加法逆元为
![](../../../public/img/2024/5ecc2f892857e82a7087c74872f755ab.png)

### 有符号数的逆元

![](../../../public/img/2024/53c8e232834f6eaadef4c46d2b489139.png)
 TMin的逆元是它本身 ，其他有符号数的逆元是它的相反数

## 整数的乘法

### 无符号数乘法

![](../../../public/img/2024/b1794d758ed686a4f76e3f5290b7a600.png)

### 有符号数（补码）乘法

截断后的结果与无符号等效
![](../../../public/img/2024/31a9129f9074c4254756510c69f190cd.png)

![](../../../public/img/2024/bb6c48b81eac4f4e76cc015ec714a459.png)
虽然无符号数和补码两种乘法乘积的完整位表示不同，但是截断之后结果的位级表示却相同

通俗解释：将二进制翻译成无符号和有符号值，乘。得到两种结果，再转成二进制截断后的值相同。

> 编译器一般使用移位、加法代替整数乘法操作
### 无符号数乘法的机器实现

当做有符号数时也可以，补码**加减**结果与无符号相同，**乘法**的截断结果也相同。即转为加减与移位时，无符号与有符号的结果等效
#### 左移

![](../../../public/img/2024/35149c6fab5af0b4b1a749dad85bc975.png)

#### 无符号乘法转为移位和加法

计算机内部一般将乘法转为移位和加法

![](../../../public/img/2024/55a289fd97a4217420056e7d1b645115.png)

## 整数的除法

除法向0舍入
![](../../../public/img/2024/9a9fe122e5e1aab7d1e7b3a4dd974623.png)

### 无符号数除法 逻辑右移


![](../../../public/img/2024/ab2894288ede21dc25bdd015ba669729.png)

设
![](../../../public/img/2024/19ef6b5c920ae6436e28e50f43ed0b39.png)
将x1左移k位
![](../../../public/img/2024/5b0206920624c46d3fe78610b414e45f.png)
得
![](../../../public/img/2024/f8ffa46d6695c197cbe1a07e52171f48.png)
令`x=x1*2^k+x2`
![](../../../public/img/2024/278d02234f17b732885e85c58acbe57f.png)
知
![](../../../public/img/2024/47d2bedd87794a9c0b949d565825c51e.png)
### 有符号数（补码）除法 算数右移 - 无证明

符号位为0的与无符号相同

符号位为1的负数移位如图所示
![](../../../public/img/2024/3a9937aa8eeaa38dece2d10ff4c6d6d6.png)
会有不合适的舍入
![](../../../public/img/2024/0bd91715e16baac92421e30bf5f4546c.png)
需要加入偏置，来修正
![](../../../public/img/2024/9b2d9e9c3f8112c0df034ab81c2fa2e8.png)
无法推广到除以任意常数
![](../../../public/img/2024/983b7ad4054abeb81d2c84a415d22431.png)
![](../../../public/img/2024/069386392862ab40c64e4c068ac66d5a.png)


