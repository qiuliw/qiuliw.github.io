---
title: 计算机组成与体系结构
date: 2024/07/02 12:18
categories:
  - 考证比赛
tags:
  - 软考
---
# 计算机组成与体系结构

::: tip 计算机系统结构的发展

1964 年，阿姆达尔(G.M.Amdahl)在介绍IBM360系统时指出:**计算机体系结构是站在程序员的角度所看到的计算机属性，即程序员要能编写出可在机器上正确运行的程序所必须了解的概念性结构和功能特性。**

1982 年，梅尔斯 (G.J.Myers)在其所著的《计算机体系结构的进展》(AdvancesinComputer Architecture)一书中定义了组成计算机系统的若干层次，每一层都提供一定的功 能支持它上面 的一层，并把不同层之间的界面定义为某种类型的体系结构。Myers 的定义发展了Amdahl 的概念性结构思想，明确了**传统体系结构就是指硬件与软件之间的界面，即指令集体系结构。**

 1984年，拜尔(J.L.Baer)在一篇题为“计算机体系结构(ComputerArchitecture)” 的文章中给 出了一 个含义更加广泛的定 义:体系结构由结构、组织、实现、 性能 4 个基本方面组成。 其中，结构指计算机系统各种硬件的互连，组织指各种部件的动态联系与管理，实现指各模块 设计的组装完成，性能指计算机系统的行为表现。这个定义发展了Amdahl 的功能特性思想。显然 ， 这里的计算机系统组织又成为体系结构的一个子集。
 
 计算机体系结构、计算机组织和计算机实现三者的关系如下。
 
1. 计算机体系结构 (ComputerArchitecture）是指计算机的**概念性结构和功能属性**。 
2. 计算机组织（ComputerOrganization）是指计算机体系结构的**逻辑实现**，包括机器内的数据流和控制流的组成以及逻辑设计等（常称为计算机组成原理）。 
3. 计算机实现（ComputerImplementation）是指计算机组织的**物理实现**（如微机原理）。

:::

课程内容提要

- 数据的表示
- 计算机结构
- Flynn分类法-对计算机类型分类
- CISC与RISC-计算机指令集
- 流水线技术
- 存储系统
- 总线系统
- 可靠性
- 校验码

## 数据的表示

### 进制的转换

略【微机原理】

### 原码反码补码移码

略【微机原理】

### 浮点数运算

**浮点数表示**
$$N=M*R^e$$
- M尾数
- e是指数
- R是基数

例如 $119 = 1.19 * 10^2$
- 1.19是尾数
- 2是指数
- 10是基数

**浮点数加减**

1. 对阶：将阶数大的阶数提出到尾数，使两数阶数相同
2. 尾数计算
3. 结果格式化

对阶

![](../../../public/img/2024/Pasted%20image%2020240701131219.png)
10^3 提一个10 到1.0，阶数基数相同，直接计算尾数

尾数计算: 10.0 + 1.19 =11.19

结果格式化

## CPU结构

![](../../../public/img/2024/Pasted%20image%2020240701131718.png)

## Flynn 分类法

指令流 | 数据流

| 体系结构类型            | 结构                            | 关键特性                | 代表                        |
| ----------------- | ----------------------------- | ------------------- | ------------------------- |
| 单指令流 \| 单数据流 SISD | 控制部分：1个<br>处理器：1个<br>主存模块：1个  |                     | 单处理器系统                    |
| 单指令流 \| 多数据流 SIMD | 控制部分：1个<br>处理器：多个个<br>主存模块：多个 | 各处理器以异步的形式执行同一条指令   | 并行处理机<br>阵列处理机<br>超级向量处理机 |
| 多指令流 \| 单数据流 MISD | 控制部分：多个<br>处理器：1个<br>主存模块：多个  | 被证明是不可能，至少是不实际的     | 目前没有，有文献称流水线计算机为此类        |
| 多指令流 \| 多数据流 MIMD | 控制部分：多个<br>处理器：多个<br>主存模块：多个  | 能够实现作业、任务、指令等各级全面并行 | 多处理机系统<br>多计算机            |

## CISC 与 RISC


| 指令系统类型   | 指令                                               | 寻址方式  | 实现方式                       | 其他            |
| -------- | ------------------------------------------------ | ----- | -------------------------- | ------------- |
| CISC(复杂) | 数量多，使用频率差别大，<br>可变长格式                            | 支持多种  | 微程序控制技术                    | 研制周期长         |
| RISC(精简) | 数量少，使用频率接近，定长格式，大部分为单周期指令，操作寄存器，只有Load/Store操作内存 | 支持方式少 | 增加了通用寄存器；硬布线逻辑控制为主；适合采用流水线 | 优化编译，有效支持高级语言 |


## 流水线

流水线是指在程序执行时多条指令重叠进行操作的一种准并行处理实现技术。各种部件同时处理是针对不同指令而言的，它们可同时为多条指令的不同部分进行工作，以提高各部件的利用率和指令的平均执行速度

![](../../../public/img/2024/Pasted%20image%2020240701181200.png)

### 流水线周期及流水线执行时间

流水线周期为执行时间最长的一段

流水线计算公式为：`1条指令的执行时间 +（指令条数-1）* 流水线周期 ` 

- 理论公式：$(t_1+t_2+...+t_k)+(n-1)*\Delta t$
- 实践公式：$(k+n-1) * \Delta t$
	- k：一条指令包括几个流水线周期。将第一条指令的各阶段周期看做流水线周期

![](../../../public/img/2024/Pasted%20image%2020240701181605.png)

![](../../../public/img/2024/Pasted%20image%2020240701231336.png)

例：若指令流水线把一条指令分为取指、分析和执行三部分，且三部分的时间分别是取指2ns，分析2ns，执行1ns。那么，流水线周期是多少？
100条指令全部执行完毕需要的时间是多少？

```
理论（2+2+1）+ (100-1)*2 = 203 ns
实践 (3+100-1)*2 = 204ns
```

### 流水线的吞吐率

流水线的吞吐率（Though Put rate, TP）是指在单位时间内流水线所完成的任务数量或输出的结果数量。

计算流水线吞吐率的最基本的公式如下

$$TP=\frac{指令条数}{流水线执行时间}$$

流水线最大吞吐率：

$$\lim_{x \to \infty} \frac{n}{(k+n-1)\Delta t} = \frac{1}{\Delta t}$$


### 流水线的加速比

完成同样一批任务，不使用流水线所用的时间与使用流水线所用的时间之比称为流水线的加速比。

计算流水线加速比的基本公式如下：

$$S=\frac{不使用流水线执行时间}{使用流水线执行时间}$$

### 流水线的效率

流水线的效率是指流水线的设备利用率。在时空图上，流水线的效率定义为n个任务
占用的时空区与k个流水段总的时空区之比。


计算流水线效率的公式为：

$$E=\frac{n个任务占用的时空区}{k个流水段的总的时空区}=\frac{T_0}{kT_k}$$

![](../../../public/img/2024/Pasted%20image%2020240702120221.png)

## 计算机层次化存储结构

![](../../../public/img/2024/Pasted%20image%2020240702122211.png)

### Cache

概念

- Cache的功能：提高CPU数据输入输出的速率，突破冯•诺依曼瓶颈，即CPU与存储系统间数据传送带宽限制。
- 在计算机的存储系统体系中，Cache是访问速度最快的层次。
- 使用Cache改善系统性能的依据是程序的局部性原理。

::: tip 使用“Cache+主存储器”的系统的平均周期
如果以 $h$ 代表对Cache的访问命中率，$t_1$ 表示Cache的周期时间，$t_2$ 表示主存储器周期
时间，以读操作为例，使用“Cache+主存储器”的系统的平均周期为 $t_3$，则：

$$t_3=h\times t_1+(1-h) \times t_2$$

其中，`(1-h)` 又称为失效率（未命中率）
:::

### 局部性原理

- 空间局部性：访问的内存位置在物理上邻近，一次访问后，其**附近的内存位置**很快也会被访问。
- 时间局部性：被访问过的内存位置或指令在**不久的将来**很可能再次被访问。
- 工作集理论：工作集是进程运行时被频繁访问的页面集合

例：

```cpp
    int i,j,s=0;
    for(i=1;i<1000;i++)
        for(j=1;j<1000;j++)
            s+=j;
    cout << s;
```


### 主存

分类

![](../../../public/img/2024/Pasted%20image%2020240702130357.png)

**1．随机存取存储器**

随机存取存储器，就是可以读出和写入的半导体存储器，简称RAM。CPU根据RAM的地址作随机地读取或写入操作，而存取操作所需的时间与信息存储位置是无关的。由于RAM的这个特点，在内存中RAM作为主体部分。根据RAM器件结构又可分为静态RAM和动态RAM两种。

1）静态RAM（Static RAM）
静态RAM存储器简称SRAM。这种存储器件的特点是存取速度很快，在不掉电的情况下，SRAM中的数据不会自动消失。SRAM采用多管的MOS器件构成，器件与微处理器的连接比较方便，但集成度较低且功耗较大。常见的SRAM有2114、6116、6264等。这类器件常在存储容量较少的系统中使用，如高速缓冲存储器（Cache）。

2）动态RAM（Dynamic RAM）
动态RAM存储器简称DRAM。这种存储器件在使用时，要求定期地进行刷新操作（Refresh）；否则，DRAM中的信息在2～8 ms后便自动消失。故需要增设额外的刷新电路，即重写电路。DRAM采用单管MOS构成，集成度高，功耗也很小。SRAM速度是DRAM的2～5倍，但SRAM价格比较贵。因此，微机的内存都用DRAM作为主要部件。常见的DRAM有2116、2118、6164、MN4164等。
另外，还有准静态RAM（Pseudo Static RAM），简称PSRAM。这是一种介于SRAM和DRAM之间的存储器件。

**2．只读存储器**

只读存储器简称ROM。特点是在系统运行时只能读取，不能写入，关闭电源后ROM中的信息不会丢失。因此，ROM被用于存放系统程序（如BIOS）和固化应用程序。这类存储器根据电路结构可分为以下几种。

（1）PROM：可编程ROM（Programmable ROM）。
将程序写入PROM后，就不可以再修改。

（2）EPROM：可擦除、可编程ROM（Erasable PROM）。
设计的程序写入后，可用紫外光照射擦除ROM中的内容，重新写入新的程序。

（3）E2 PROM：电可擦除、可编程ROM（Electrically Erasable PROM）。
被固化在该芯片中的程序，可以利用电压来擦除，重新写入新的程序。

性能

![](../../../public/img/2024/Pasted%20image%2020240702130851.png)


### 磁盘结构和参数

![](../../../public/img/2024/Pasted%20image%2020240702131914.png)

$$存取时间=寻道时间+等待时间(平均定位时间+转动延迟)$$

- 寻道时间是指磁头移动到磁道所需的时间；
- 等待时间为等待读写的扇区转到磁头下方所用的时间；

试题

![](../../../public/img/2024/Pasted%20image%2020240702134941.png)


![](../../../public/img/2024/Pasted%20image%2020240702140333.png)

**1. 未优化**

R0-R9

- R0 读取 3ms
- R0 处理+转动到下一区 33ms
- 共 `（33+3）*10=360 ms`

R10

- 读取 3ms
- 处理 3ms

共 360+6 =366 ms

**2. 优化后**

R0-R9

- R0 读取 3ms
- R0 处理+转动到下一区 3ms
- 共 `（3+3）*10=60 ms`

R10

- 读取 3ms
- 处理 3ms

共 60+6 =66 ms

## 总线

根据所处位置

- 内部总线
- 系统总线：DB、AB、CB
- 外部总线

## 系统可靠性分析

### 串联系统与并联系统

**串联模型**

![](../../../public/img/2024/%E4%B8%B2%E8%81%94.svg)

可靠性
$$R=R_1 \times R_2 \times ... \times R_n$$

失效率（近似公式）
$$\lambda = {\lambda}_1 +{\lambda}_2+...+{\lambda}_n $$

**并联模型**

![](../../../public/img/2024/%E5%B9%B6%E8%81%94.svg)

可靠性
$$R=1-(1-R_1) \times (1-R_2) \times ... \times (1-R_n)$$

失效率
$$\mu = \frac{1}{\frac{1}{\lambda}\sum_{j=1}^{n} \frac{1}{j} } $$
$$\mu =1-R$$


### 模冗余系统与混合系统

模冗余系统(基本不考)

![](../../../public/img/2024/%E6%91%B8%E5%86%97%E4%BD%99.svg)

$$R= \sum_{i=n+1}^{m} C_m^j \times R_0^i(1-R_0)^{m-i}$$

混合系统

![](../../../public/img/2024/%E6%B7%B7%E5%90%88.svg)

$$R\times(1-(1-R)^3)\times(1-(1-R)^2)$$


## 差错控制-校验码


::: tip 什么是检错和纠错？
检错只检测出错误即可
纠错不但检测出错误还需要将其纠正
:::

::: tip 什么是码距？
一个编码系统的码距是整个编码系统中任意（所有）两个码字的最小距离。

例：

若用1位长度的二进制编码。若A=1，B=0。这样A、B之间的最小码距为1。

若用2位长度的二进制编码，若以A=11，B=00为例，A、B之间的最小码距为2。

若用3位长度的二进制编码，可选用111，000作为合法编码。A、B之间的最小码距为3。
:::

::: tip 码距与检错、纠错有何关系？
1. 在一个码组内为了检测e个误码，要求最小码距d应该满足：d>=e+1
2. 在一个码组内为了纠正t个误码，要求最小码距d应该满足：d>=2t+1
:::

### 奇偶校验码

奇偶校验(Parity Codes)

是一种简单而有效的校验方法。这种方法通过在编码中增加一位校验位来使编码中1的个数为奇数（奇校验）或者为偶数（偶校验），从而使码距变为2。对于奇校验，它可以检测代码中奇数位出错的编码，但不能发现偶数位出错的情况，即当合法编码中的奇数位发生了错误时，即编码中的1变成0或0变成1，则该编码中1的个数的奇偶性就发生了变化，从而可以发现错误。

常用的奇偶校验码有3种：水平奇偶校验码、垂直奇偶校验码和水平垂直校验码。

二维奇偶校验
![](../../../public/img/2024/Pasted%20image%2020240703210419.png)
可以检测一位错误


### 模2除法

 引用自 https://wenku.baidu.com/view/460ee236c181e53a580216fc700abb68a982adda.html?fr=aladdin664466&ind=1&aigcsid=0&qtype=0&lcid=1&queryKey=%E6%A8%A12%E9%99%A4%E6%B3%95&_wkts_=1719921939143&bdQuery=%E6%A8%A12%E9%99%A4%E6%B3%95
 
十进制的除法，大家都会做：列个竖式，商，写在上面，上个几，再用
被除数减去积，求得余数…。

二进制的除法，和十进制的计算方法相同，也要列出个竖式计算。

二进制的除法，还有一种“模2除”，很多人就不熟悉了，甚至连“百度百科”中，也写不清楚这个概念和方法。此外还有：“模2和”、“模2减”等等。

二进制数字的计算，很有特点。

两个二进制数字的相加，如果不考虑进位，就是“模2和”；

两个二进制数字的相减，如果不考虑借位，就是“樟2减”

“模2和”、“模2减”，名称、算法虽然不一样，但是，结果是相同的，实际上都是两个二进制数字相“异或”。

如果两个二进制数字相同，“异或”的结果就是0；

如果两个二进制数字不同，“异或”的结果就是1。

“模2除”就是在求余数的时候，应用了“模2减”。

下图就是“二进制的除法”和“模2除”的计算过程竖式：

![](../../../public/img/2024/Pasted%20image%2020240702201614.png)

在“模2除”中，因为使用了“模2减”，所以在商上1的时候，不要考虑够不够减（因为这里不是二进制的除法），**只要最高位是1，位数凑够了四位，就可以用它“模2减”1001。**

“模2除”在“循环冗余校验（CRC）”中，有广泛的应用。

> 总结：不考虑进借位，最高位是1，商的某位乘出来的数 和除数的位数对齐，就可以异或

### 循环校验码（CRC）

例：原始报文为“11001010101”，其生成多项式为：“ $x^4+x^3+x+1$ ”，对其进行CRC编码后的结果为？

多项式 x的多少次方指示了相应权重的二进制位是0还是1

生成多项式作为除数，原始后面补0（生成多项式长度-1 个0）作为被除数。

![](../../../public/img/2024/Pasted%20image%2020240702210006.png)

将余数替换掉原始报文所补的0，得到结果

### 海明校验码



![](../../../public/img/2024/Pasted%20image%2020240703024233.png)

校验码的范围 应当可以区分出 数据正确（编码全0）和 第几位出错

![](../../../public/img/2024/Pasted%20image%2020240703031657.png)

数据位与校验位之间位数的关系
![](../../../public/img/2024/Pasted%20image%2020240703040040.png)

